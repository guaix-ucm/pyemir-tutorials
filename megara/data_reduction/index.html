
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Data reduction &#8212; numina-tutorials v0.22 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Bias image" href="bias.html" />
    <link rel="prev" title="MEGARA tutorials" href="../index.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="data-reduction">
<h1>Data reduction<a class="headerlink" href="#data-reduction" title="Permalink to this headline">¶</a></h1>
<div class="section" id="data-organization">
<h2>Data organization<a class="headerlink" href="#data-organization" title="Permalink to this headline">¶</a></h2>
<p>MEGARA DRP uses its own data organization to work. We need a directory named
MEGARA, in our example this directoryis under data_reduction/:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(megara) bash-3.2$ pwd/Users/acm/Desktop/data_reduction/MEGARA
</pre></div>
</div>
<p>Under the MEGARA/directory we need to have the calibration tree with the
specific name ca3558e3-e50d-4bbc-86bd-da50a0998a48/, which is the string that
uniquely identifies the instrument configuration (a different name was, for
example, used during laboratory integration at LICA-UCM). Under the MEGARA/
directory we can also have the requirements file named control.yaml needed
to run the pipeline (see section 5.3; note that the tree command
shown below might not be available in certain unix distributions;
use “ls” instead).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(megara) bash-3.2$ tree -L 2
.
└── MEGARA
    ├── M15
    ├── M71
    ├── ca3558e3-e50d-4bbc-86bd-da50a0998a48
    └── control.yaml
</pre></div>
</div>
<p>The requirements file control.yaml contains the path for your MEGARA/
directory:</p>
<p>rootdir: /Users/acm/Desktop/data_reduction</p>
<p>and useful information for performing the wavelength calibration of each VPH,
including the number of emission lines, wavelength ranges and degree of
polynomial fit to be used by the wavelength calibration recipe.
In this file you can also specify the name for the extinction curve file used
for the flux calibration recipe. This is simply an ASCII file with two
space-separated columns, one with the wavelength in Angstroms and another with
the magnitudes of extinction per unit airmass at the corresponding wavelength,
i.e. the same format used for extinction curves within IRAF.
We strongly recommend to use the standard extinction curve of
the Roque de los Muchachos Observatory.</p>
<p>(megara) bash-3.2$ more control.yaml version: 1rootdir: /Users/acm/Desktop/REDUCTION_MEGARA/reduction_GTC_comproducts:MEGARA:-{id: 2, type: ‘ReferenceExtinctionTable’, tags: {}, content: ‘extinction_LP.txt’}requirements:MEGARA:default:MegaraArcCalibration:-{name: nlines, tags: {vph: LR-U, speclamp: ThAr, insmode: LCB}, content: [25,25]}-{name: nlines, tags: {vph: LR-U, speclamp: ThAr, insmode: MOS}, content: [25,25]}-{name: nlines, tags: {vph: LR-B, speclamp: ThAr, insmode: LCB}, content: [10,10,15,5]}-{name: nlines, tags: {vph: LR-B, speclamp: ThAr, insmode: MOS}, content: [10,10,15,5]}-{name: nlines, tags: {vph: LR-V, speclamp: ThAr, insmode: LCB}, content: [15,5,10,7]}-{name: nlines, tags: {vph: LR-V, speclamp: ThAr, insmode: MOS}, content: [15,5,10,7]}-{name: nlines, tags: {vph: LR-R, speclamp: ThAr, insmode: LCB}, content: [14,7]}-{name: nlines, tags: {vph: LR-R, speclamp: ThAr, insmode: MOS}, content: [14,7]}-{name: nlines, tags: {vph: LR-I, speclamp: ThAr, insmode: LCB}, content: [14]}-{name: nlines, tags: {vph: LR-I, speclamp: ThAr, insmode: MOS}, content: [14]}-{name: nlines, tags: {vph: LR-Z, speclamp: ThNe, insmode: LCB}, content: [14,9]}-{name: nlines, tags: {vph: LR-Z, speclamp: ThNe, insmode: MOS}, content: [14,9]}-{name: nlines, tags: {vph: MR-U, speclamp: ThAr, insmode: LCB}, content: [8,10]}-{name: nlines, tags: {vph: MR-U, speclamp: ThAr, insmode: MOS}, content: [8,10]}-{name: nlines, tags: {vph: MR-UB, speclamp: ThAr, insmode: LCB}, content: [20]}-{name: nlines, tags: {vph: MR-UB, speclamp: ThAr, insmode: MOS}, content: [20]}-{name: nlines, tags: {vph: MR-B, speclamp: ThAr, insmode: LCB}, content:[11]}-{name: nlines, tags: {vph: MR-B, speclamp: ThAr, insmode: MOS}, content: [11]}-{name: nlines, tags: {vph: MR-G, speclamp: ThAr, insmode: LCB}, content: [10,10,8]}-{name: nlines, tags: {vph: MR-G, speclamp: ThAr, insmode: MOS}, content: [10,10,8]}-{name: nlines, tags: {vph: MR-V, speclamp: ThAr, insmode: LCB}, content: [13,8]}-{name: nlines, tags: {vph: MR-V, speclamp: ThAr, insmode: MOS}, content: [13,8]}-{name: nlines, tags: {vph: MR-VR, speclamp: ThNe, insmode: LCB}, content: [14]}-{name: nlines, tags: {vph: MR-VR, speclamp: ThNe, insmode: MOS}, content: [14]}-{name: nlines, tags: {vph: MR-R, speclamp: ThNe, insmode: LCB}, content: [9]}-{name: nlines, tags: {vph: MR-R, speclamp: ThNe, insmode: MOS}, content: [9]}-{name: nlines, tags: {vph: MR-RI, speclamp: ThNe, insmode: LCB}, content: [7]}-{name: nlines, tags: {vph: MR-RI, speclamp: ThNe, insmode: MOS}, content: [7]}-{name: nlines, tags: {vph: MR-I, speclamp: ThNe, insmode: LCB}, content: [5,5,5]}-{name: nlines, tags: {vph: MR-I, speclamp: ThNe, insmode: MOS}, content: [5,5,5]}-{name: nlines, tags: {vph: MR-Z, speclamp: ThNe, insmode: LCB}, content: [4,5,3]}-{name: nlines, tags: {vph: MR-Z, speclamp: ThNe, insmode: MOS}, content: [4,5,3]}
-{name: nlines, tags: {vph: HR-R, speclamp: ThNe, insmode: LCB}, content: [5]}-{name: nlines, tags: {vph: HR-R, speclamp: ThNe, insmode: MOS}, content: [5]}-{name: nlines, tags: {vph: HR-I, speclamp: ThNe, insmode: LCB}, content: [10]}-{name: nlines, tags: {vph:HR-I, speclamp: ThNe, insmode: MOS}, content: [10]}-{name: polynomial_degree, tags: {vph: LR-U, speclamp: ThAr}, content: [3,5]}-{name: polynomial_degree, tags: {vph: LR-B, speclamp: ThAr}, content: [5,5]}-{name: polynomial_degree,tags: {vph: LR-V, speclamp: ThAr}, content: [5,5]}-{name: polynomial_degree, tags: {vph: LR-R, speclamp: ThAr}, content: [3,5]}-{name: polynomial_degree, tags: {vph: LR-I, speclamp: ThAr}, content: [3,5]}-{name: polynomial_degree, tags: {vph: LR-Z, speclamp: ThNe}, content: [3,5]}-{name: polynomial_degree, tags: {vph: MR-U, speclamp: ThAr}, content: [3,5]}-{name: polynomial_degree, tags: {vph: MR-UB, speclamp: ThAr}, content: [3,5]}-{name: polynomial_degree, tags: {vph: MR-B, speclamp: ThAr}, content: [3,5]}-{name: polynomial_degree, tags: {vph: MR-G, speclamp: ThAr}, content: [3,5]}-{name: polynomial_degree, tags: {vph: MR-V, speclamp: ThAr}, content: [3,5]}-{name: polynomial_degree, tags: {vph: MR-VR, speclamp: ThNe}, content: [3,5]}-{name: polynomial_degree, tags: {vph: MR-R, speclamp: ThNe}, content: [3,3]}-{name: polynomial_degree, tags: {vph: MR-RI, speclamp: ThNe}, content: [3,3]}-{name: polynomial_degree, tags: {vph: MR-I, speclamp: ThNe}, content: [3,5]}-{name: polynomial_degree, tags: {vph: MR-Z, speclamp: ThNe}, content: [3,3]}-{name: polynomial_degree, tags: {vph: HR-R, speclamp: ThNe}, content: [3,5]}-{name: polynomial_degree, tags: {vph: HR-I, speclamp: ThNe}, content: [3,5]}</p>
<p>Another fundamental function of the calibration
tree (ca3558e3-e50d-4bbc-86bd-da50a0998a48/) is to host the calibration
products that will be used by the corresponding recipes, such as the
MasterBias, MasterFiberFlat, MasterSensitivity, etc.
Thus, once the files for these calibrations are generated, they should be
copied under this calibration tree according structure below.
Since the DRP would read the first file in alphabetical order inside the
corresponding folder, we recommend to place only one file in each folder.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(megara) bash-3.2$ tree ca3558e3-e50d-4bbc-86bd-da50a0998a48/ -L 2
ca3558e3-e50d-4bbc-86bd-da50a0998a48/
├── LinesCatalog
│   ├── ThAr
│   └── ThNe
├── MasterBPM
│   └── master_bpm.fits
├── MasterBias
│   └── master_bias.fits
├── MasterFiberFlat
│   ├── LCB
│   └── MOS
├── MasterSensitivity
│   ├── LCB
│   └── MOS
├──MasterSlitFlat
│
├── MasterTwilightFlat
│   ├── LCB
│   ├── ModelMap
│   ├── LCB
│   └── MOS
├── TraceMap
│   ├── LCB
│   └── MOS
└── WavelengthCalibration
    ├── LCB
    └── MOS
</pre></div>
</div>
<p>The  content  for  the LinesCatalog/ is specific for  each VPH
(line  lists  for  all  VPHs  can  be  found  at
<cite>https://zenodo.org/record/2270518#.XRx9HKZS9E4</cite>).
In the following example the calibration files for the HR-R
(LCB observing mode) and LR-R (MOS observing mode) VPHs are shown.
When other VPHs are used, the user just needs to create the corresponding
folders. It is recommended to have only one file in each calibration directory.
For example,for the same VPH you can have several <cite>master_traces.json</cite>
files with the information to trace the fibers light through the detector
at thesame day but at different ambient temperatures.</p>
<p>Different files can be stored atthe same directory, but the DRP is going to
use the first file it encounters in alphabetical order. The user can name
the desired file with prefix 00 (e.g. <cite>00_master_traces.json</cite>) to be sure
this is the file to be used by the DRP. Note that the sorting of files
named <cite>00_</cite> and <cite>000_</cite> might be different for the operative system and
for the MEGARA DRP, so avoid making abusive use of these prefixes.</p>
<p>Furthermore,the user’s MEGARA/ directory can contain data for your targets
under different directories (in this example our targets are the M15 and M71
globular clusters). Your raw data should always be included in a
subdirectory named data/ within each working target directory (M15, M71, etc.).
Images can be stored gzipped but then the observation-result files
should list the images with the .gz extension.
The different observation-result files (<cite>*.yaml</cite>) used during the data
reduction process should be also located within each target directory
as they will be different for each target.
In this example, the observation-resultfiles in YAML format are named
with a first number related with the order they are run.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="bias.html">Bias image</a></li>
</ul>
</div>
</div>
</div>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="../index.html" title="Previous document">MEGARA tutorials</a>
        </li>
        <li>
          <a href="bias.html" title="Next document">Bias image</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">numina-tutorials</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../emir/index.html">EMIR tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">MEGARA tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Data reduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../megara_tools/index.html">MEGARA tools</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">MEGARA tutorials</a><ul>
      <li>Previous: <a href="../index.html" title="previous chapter">MEGARA tutorials</a></li>
      <li>Next: <a href="bias.html" title="next chapter">Bias image</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018-2020, Universidad Complutense de Madrid.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/megara/data_reduction/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>